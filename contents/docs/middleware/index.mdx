---
title: The middlewares
---

Efri has a middleware system that allows you to add functionality & checks to your routes.

You already have 2 demo middlewares in Efri, the `logger` and the `auth` middlewares.

<Note type="warning">
This is still work in progress, and the middleware system is not yet stable.
</Note>

## Configuration

1. Create a middleware file same as logger and auth are done.
2. Create the middleware class and implement the `MiddlewareHandler` interface.
```ts
import type { MiddlewareHandler } from "efri/core/types/middleware";

export class MyFirstMiddleware implements MiddlewareHandler {
  async handle(req: Request, next: () => Promise<Response>): Promise<Response> {
    console.log("This is my first middleware");
    return next();
  }
}
```

3. Register the middleware in the `index.ts` file from within middlewares folder.

```ts
export default {
  "auth": new AuthMiddleware(),
  "logger": new LoggerMiddleware(),
  'my-first-middleware': new MyFirstMiddleware(),
};
```

4. Make use of it.

```ts
router.get('/my-route', ({ req, res }) => {
  return res.json({ message: 'New route to test the middleware' });
}, ['my-first-middleware']);

// or

router.get('/my-route', [MyController, 'index'], ['my-first-middleware']);
```
